{"version":3,"file":"LoggerBuilder.js","names":["LoggerBuilder","factory","context","level","window","hasOwnProperty","OC","config","loglevel","undefined","LogLevel","Warn","debug","Debug","appId","app","uid","user","getCurrentUser"],"sources":["../lib/LoggerBuilder.ts"],"sourcesContent":["/// <reference types=\"@nextcloud/typings\" />\n\nimport { getCurrentUser } from '@nextcloud/auth'\nimport { ILogger, ILoggerFactory, LogLevel } from './contracts'\n\ndeclare var OC: Nextcloud.v22.OC | Nextcloud.v23.OC | Nextcloud.v24.OC;\n\nexport class LoggerBuilder {\n\n    private context: any\n\n    private factory: ILoggerFactory\n\n    constructor(factory: ILoggerFactory) {\n        this.context = {}\n        this.factory = factory\n        // Up to, including, nextcloud 24 the loglevel was not exposed\n        this.context.level = (window.hasOwnProperty('OC') && OC?.config?.loglevel !== undefined) ? OC.config.loglevel : LogLevel.Warn\n        // Override loglevel if we are in debug mode\n        if (window.hasOwnProperty('OC') && OC?.debug) {\n            this.context.level = LogLevel.Debug\n        }\n    }\n\n    setApp(appId: string): LoggerBuilder {\n        this.context.app = appId\n        return this\n    }\n\n    setLogLevel(level: LogLevel) {\n        this.context.level = level\n        return this\n    }\n\n    setUid(uid: string): LoggerBuilder {\n        this.context.uid = uid\n        return this\n    }\n\n    detectUser(): LoggerBuilder {\n        const user = getCurrentUser()\n        if (user !== null) {\n            this.context.uid = user.uid\n        }\n\n        return this\n    }\n\n    build(): ILogger {\n        return this.factory(this.context)\n    }\n\n}\n"],"mappings":";;;;;;;AAEA;AACA;AAA+D;AAAA;AAAA;AAAA;AAAA,IAIlDA,aAAa;EAMtB,uBAAYC,OAAuB,EAAE;IAAA;IAAA;IAAA;IAAA;IACjC,IAAI,CAACC,OAAO,GAAG,CAAC,CAAC;IACjB,IAAI,CAACD,OAAO,GAAGA,OAAO;IACtB;IACA,IAAI,CAACC,OAAO,CAACC,KAAK,GAAIC,MAAM,CAACC,cAAc,CAAC,IAAI,CAAC,IAAI,QAAAC,EAAE,sDAAF,IAAIC,MAAM,+CAAV,WAAYC,QAAQ,MAAKC,SAAS,GAAIH,EAAE,CAACC,MAAM,CAACC,QAAQ,GAAGE,mBAAQ,CAACC,IAAI;IAC7H;IACA,IAAIP,MAAM,CAACC,cAAc,CAAC,IAAI,CAAC,YAAIC,EAAE,iCAAF,KAAIM,KAAK,EAAE;MAC1C,IAAI,CAACV,OAAO,CAACC,KAAK,GAAGO,mBAAQ,CAACG,KAAK;IACvC;EACJ;EAAC;IAAA;IAAA,OAED,gBAAOC,KAAa,EAAiB;MACjC,IAAI,CAACZ,OAAO,CAACa,GAAG,GAAGD,KAAK;MACxB,OAAO,IAAI;IACf;EAAC;IAAA;IAAA,OAED,qBAAYX,KAAe,EAAE;MACzB,IAAI,CAACD,OAAO,CAACC,KAAK,GAAGA,KAAK;MAC1B,OAAO,IAAI;IACf;EAAC;IAAA;IAAA,OAED,gBAAOa,GAAW,EAAiB;MAC/B,IAAI,CAACd,OAAO,CAACc,GAAG,GAAGA,GAAG;MACtB,OAAO,IAAI;IACf;EAAC;IAAA;IAAA,OAED,sBAA4B;MACxB,IAAMC,IAAI,GAAG,IAAAC,oBAAc,GAAE;MAC7B,IAAID,IAAI,KAAK,IAAI,EAAE;QACf,IAAI,CAACf,OAAO,CAACc,GAAG,GAAGC,IAAI,CAACD,GAAG;MAC/B;MAEA,OAAO,IAAI;IACf;EAAC;IAAA;IAAA,OAED,iBAAiB;MACb,OAAO,IAAI,CAACf,OAAO,CAAC,IAAI,CAACC,OAAO,CAAC;IACrC;EAAC;EAAA;AAAA;AAAA"}